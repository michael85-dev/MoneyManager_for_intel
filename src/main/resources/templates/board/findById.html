<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<head>
    <meta charset="UTF-8">
    <title>Money Manager</title>
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
</head>
<body>
<header>
board findById page
    <!-- 위에 선택 탭 -->
</header>
<main>
    <div>
        <!-- 각종 정보 관련 넣기 -->
        <button th:href="@{|/board/update/${bDTO.boardId}|}"></button><button onclick="deleteInfo()"></button>
    </div>
    <div th:object="${bDTO}">
        <span th:text="*{boardId}">번호</span>
        <span th:text="*{boardTitle}">제목</span>
        <span th:text="*{boardWriter}">작성자</span>
        <span th:text="*{boardContents}">내용</span>
        <span>
            <a img src: 이미지
        </span>
        <div>
            <!-- 버튼 관련 -->
            <button onclick="bToMain()"></button><button th:onclick="deleteInfo(${bDTO.boardId})">삭제</button>
        </div>
    </div>

    <div id="comment-write"> <!-- 여기에 내용 불러와야함 (미완) -->
        <input type="text" id="commentWriter" th:value="${session.nickName}" placeholder="작성자"> <br>
        <input type="text" id="commentContents" placeholder="내용"> <br>
        <button id="comment-write-btn">댓글 등록</button>
    </div>
    <!-- 코멘트 관련 작성 -->
    <div id="comment-view">
        <table>
            <thead>
                <tr>
                    <th>댓글번호</th>
                    <th>작성자</th>
                    <th>내용</th>
                    <th>작성시간</th>
                </tr>
            </thead>
            <tbody> <!-- 나중에 처리 하기 / 아직 미완인 상태임 -->
                <td th:each="c : ${cList}">
                    <td>댓글번호</td>
                    <td>작성자</td>
                    <td>내용</td>
                    <td>작성시간</td>
                </td>
            </tbody>
        </table>
    </div>

</main>
<footer>

</footer>
</body>
<script>
    function bToMain() {
        location.href="/board/";
    }
    function deleteInfo(boardId) { // 제대로 맞게 해결해야함.
        $.ajax({
           type: 'delete?'
            url: '/board/delete/',
            data : {
               'boardId' : boardId,
            },
            success: function(result) {
                console.log('삭제 완료');
            },
            error: function() {

            }
        });
    }

    $("comment-write-btn").click(function(){
        console.log('댓글등록버튼 호출됨');
        const commentWriter = document.getElementById('commentWriter').value;
        const commentContents = $('#commentContents').val();
        const boardId = '[[${bDTO.boardId}]]'; //이게 데이터를 불러오는게 맞는가...? 확인 해야함.

        $.ajax({
            type: 'post',
            url: '/comment/save',
            data: {
                'commentWriter' : commentWriter,
                'commentContents' : commentContents,
                'boardId' : boardId
            },
            dataType: 'json',
            success: function(result) {
                console.log(result);
            },
            error: function() {
                alert('실패');
            }
        })
    });
</script>
</html>